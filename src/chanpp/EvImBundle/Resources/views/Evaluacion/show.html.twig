{% extends 'chanppEvImBundle::layout.html.twig' %}

{% block body -%}
 <h1>Evaluación "{{ entity.nombre }}"<p title="Un plan de evaluación puede tener asociadas múltiples evaluaciones (trimestrales, semestrales, al término del programa/proyecto, entre otras), es decir, evaluaciones de seguimiento o ex post. A continuación se detallan todas las evaluaciones asociadas a este Plan de Evaluación." id="formhelpshowtitle">?</p></h1>
    {# Errors go here#}
    {% if app.request.get('error') is defined %}
    <h2>{{ app.request.get('error') }}</h2>
    {% endif%}
     <a href="{{ path('planevaluacion_show', { 'id': planevaluacion.getId()}) }}" class="btn">
         Volver al Plan de Evaluación
    </a>
    {# Poner if hay resultados #}
    <a href="{{ path('evaluacion_resultados_show', { 'id': entity.id}) }}" class="btn btn-primary">
        Ver Resultados
    </a>
   <br><br>
    {% if entity.getDone() == false%}
    <a href="{{ path('evaluacion_edit', { 'id': entity.id }) }}" class="btn btn-warning">
        Editar Evaluación
    </a>
    {% endif %}
    
    {% if entity.getDone() == false%}
    <a href="{{ path('evaluacion_mark_done', { 'id': entity.id }) }}" class="btn btn-warning" 
onclick="return confirm('¿Seguro que desea marcar la evaluación como lista? Esta acción es irreversible.')">
     Marcar como lista
    </a><br><br>{% if entity.getDone() == false%}
        {% if (is_granted("ROLE_ADMIN") or is_granted("ROLE_SUPER_ADMIN")) %}
        <form action="{{ path('evaluacion_delete', { 'id': entity.id }) }}" method="post">
            <input type="hidden" name="_method" value="DELETE" />
            {{ form_widget(delete_form) }}
            <button type="submit" class="btn btn-danger" onclick="return confirm('¿Seguro que desea eliminar?')">Eliminar Evaluación</button>
        </form>
        {% endif%}
     {% endif %}
    {% endif %}
    <table class="table table-striped">
        <tbody>
             <tr>
                <th>Nombre</th>
                <td>{{ entity.nombre }}</td>
            </tr>
            <tr>
                <th>Alcance<p title="En este ítem se especifican la(s) pregunta(s) clave(s) que se desea responder con la evaluación." id="formhelpshow">?</p></th>
                <td>{{ entity.alcance }}</td>
            </tr>
            <tr>
                <th>Duración</th>
                <td>{{ entity.duracion }}</td>
            </tr>
        </tbody>
    </table>
    <hr>
    {# Actividades#}
    <h4>Actividades a evaluar</h4>
        {% if actividades is empty%}
        <br>No hay actividades
          {% else %}
         <table class="table table-striped">
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Descripcion</th>
                    <th>Resultados Esperados</th>
                    <th>Duracion</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
            {% for entity2 in actividades %}
                <tr>
                    <td>{{ entity2.nombre }}</td>
                    <td>{{ entity2.descripcion }}</td>
                    <td>{{ entity2.resultadosEsperados }}</td>
                    <td>{{ entity2.duracion }}</td>
                    <td>
                            <a href="{{ path('activity_show', { 'id': entity2.id }) }}" class="btn btn-primary">Ver</a>
                            {% if (is_granted("ROLE_ADMIN") or is_granted("ROLE_SUPER_ADMIN"))%}
                            <a href="{{ path('activity_edit', { 'id': entity2.id }) }}" class="btn btn-warning">Editar</a>
                            {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% endif %}
    

    {# Fin Aspectos#}
    <hr>
    {#Evaluación Directa#}
    <h4>Evaluación de Impacto Directo<p title="El objetivo principal de una evaluación de impacto directo, es obtener una estimación de ahorros netos de energía o demanda alcanzado por efecto del programa o proyecto, de la forma más exacta e insesgada posible, dependiendo de la información disponible, el nivel de confiabilidad de la información requerida y de los recursos con que se cuenta para desarrollar la evaluación." id="formhelpshowtitle">?</p></h4>
    {% if evaluaciondirecta %}
                  <table class="table table-striped">
        <thead>
            <tr>
                <th>Resultado</th>
                <th>Descripción</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{{ evaluaciondirecta.getTotal() }} MW/h</td>
                 <td>{{ evaluaciondirecta.descripcion }}</td>
                <td>
                        <a href="{{ path('evaluaciondirecta_show', { 'id': evaluaciondirecta.id }) }}" class="btn btn-primary">Ver</a>
                    {% if entity.getDone() == false%}
                        <a href="{{ path('evaluaciondirecta_edit', { 'id': evaluaciondirecta.id }) }}" class="btn btn-warning">Editar</a>
                    {% endif %}
                </td>
            </tr>
        </tbody>
    </table>
    {% else %}
        {% if entity.getDone() == false%}
            <a href="{{ path('evaluaciondirecta_new', { 'evaluacion_id': entity.id }) }}" class="btn btn-success">
                Crear Evaluación Directa
            </a>
    {% endif %}
    {% endif %}
    {#Fin Evaluación Directa#}
    <hr>
    {#Evaluaciones Indirectas#}
    <h4>Sub-Evaluaciones de Impacto Indirecto<p title="Si lo que se requiere es medir los efectos indirectos de un programa, es decir, medir los efectos que no pueden ser directamente traducidos en energía ahorrada, corresponde realizar una evaluación de impacto indirecto. 
Una Sub-Evaluación de Impacto Indirecto corresponde a una evaluación de impacto indirecto a nivel de grupo de interés. En otras palabras, una Evaluación de Impacto Indirecto tendrá tantas Sub-Evaluaciones como grupos de interés tenga. El objetivo de esta sub-evaluación es medir el impacto del programa en uno o más de tres ejes, correspondientes a macro dimensiones analíticas, las que son:
-Presencia: El programa debe estar presente en la mente de las personas que conforman los diferentes grupos de interés. 
-Valoración: El programa debe tener una evaluación positiva y una predisposición favorable entre quienes forman parte de sus grupos de interés. 
-Capacidad movilizadora: El programa debe contar con la intensidad suficiente para transferirse en las interacciones de los miembros de sus grupos de interés y motivar a estos hacia la acción concreta buscada. " id="formhelpshowtitle">?</p></h4>
    {% if entity.getDone() == false%}
    <a href="{{ path('evaluacionindirecta_new', { 'evaluacion_id': entity.id }) }}" class="btn btn-success">
     Crear Sub-Evaluación Indirecta
    </a>
    {% endif %}
    {% if evaluacionesindirectas is empty%}
    {% else %}
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Ámbito del objetivo del programa<p title="Este campo permite seleccionar los ámbitos de acción de un programa que serán evaluados, éstos pueden ser:
-Capacitación/ Educación
-Información/Difusión
-Transformaciones de mercado." id="formhelpshow">?</p></th>
                <th>Grupo de Interés<p title="Agregar el siguiente texto de ayuda:
En este campo se debe definir el grupo de personas sobre la cual se hará una sub-evaluación indirecta." id="formhelpshow">?</p></th>
                <th>Ejes<p title="Una evaluación indirecta mide el impacto del programa en uno o más de tres ejes, correspondientes a macro dimensiones analíticas, las que son:
-Presencia: El programa debe estar presente en la mente de las personas que conforman los diferentes grupos de interés. 
-Valoración: El programa debe tener una evaluación positiva y una predisposición favorable entre quienes forman parte de sus grupos de interés. 
-Capacidad movilizadora: El programa debe contar con la intensidad suficiente para transferirse en las interacciones de los miembros de sus grupos de interés y motivar a estos hacia la acción concreta buscada." id="formhelpshow">?</p></th>
                <th>Responsable de la ejecución</th>
                <th>Plazo de la ejecución (meses)</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
        {% for entity2 in evaluacionesindirectas %}
            <tr>
                {% if entity2.ambito == 1 %}
                   <td>Capacitación/Educación</td>
                {% elseif entity2.ambito == 2 %}
                    <td>Información/Difusión</td>
                {% elseif entity2.ambito == 3 %}
                    <td>Otras Transformaciones de Mercado</td>
                {% endif %}
                <td>{{ entity2.grupoInteres }}</td>
                <td>
                {% for eje in entity2.ejes %}
                     {% if eje == 1 %}
                        Presencia<br> 
                     {% elseif eje == 2 %}
                        Valoración<br>
                     {% elseif eje == 3 %}
                        Capacidad Movilizadora<br>
                {% endif %}
                {% endfor %}
                </td>
                <td>{{ entity2.responsable }}</td>
                <td>{{ entity2.plazo }}</td>
                <td>
                <ul>
                <a href="{{ path('evaluacionindirecta_show', { 'id': entity2.id }) }}" class="btn btn-primary">Ver</a> 
                {% if entity.getDone() == false %}
                <a href="{{ path('evaluacionindirecta_edit', { 'id': entity2.id }) }}" class="btn btn-warning">Editar</a>
                {% endif %}
                </ul>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% endif %}
    {#Fin Evaluaciones Indirectas#}
{% endblock %}
