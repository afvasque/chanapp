{% extends 'chanppEvImBundle::layout.html.twig' %}

{% block body -%}
    <h1>Editar Ficha Proyecto</h1>

    <form action="{{ path('fichaproyecto_update', { 'id': entity.id }) }}" method="post" {{ form_enctype(edit_form) }}>
        <input type="hidden" name="_method" value="PUT" />
        
        {{ form_row(edit_form.area_accion) }}
        {{ form_row(edit_form.linea_accion) }}
        {{ form_row(edit_form.nombre) }}
        {{ form_row(edit_form.jefe) }}
        {{ form_row(edit_form.duracion) }}
        {{ form_row(edit_form.diagnostico_previo) }}
        {{ form_row(edit_form.obj_general) }}
        {{ form_row(edit_form.objs_especificos) }}
        {{ form_row(edit_form.descripcion) }}
        {{ form_row(edit_form.desc_causales) }}
        {{ form_row(edit_form.variables_causales) }}

        <h2> Actividades </h2>

        <div class="chanpp_evimbundle_fichaproyectotype_activities" id="chanpp_evimbundle_fichaproyectotype_activities" data-prototype="{{ form_widget(edit_form.activities.vars.prototype)|e }}">
            {% for activity in edit_form.activities %}

                {{ form_row(activity.nombre) }}
                {{ form_row(activity.descripcion) }}
                {{ form_row(activity.resultadosEsperados) }}
                {{ form_row(activity.duracion) }}
            {% endfor %}
        </div>


        {{ form_rest(edit_form) }}   

        {% if entity.getIndGestions|length>0 %}
        <h2> Indicadores de gestión </h2>
            <table class="table table-condensed">
                <tr>
                    <th>Nombre</th>
                    <th></th>
                </tr>
                <tr>
        {% for ind in entity.getIndGestions %}
                    <tr>
                        <td>{{ind.getNombre}}</td>
                        <td><a href="{{ path('indgestion_edit',{'id' : ind.getId}) }}"> 
                            Editar </a><br />
                            <a href="{{ path('indgestion_delete',{'id' : ind.getId}) }}"> 
                            Eliminar </a>
                        </td>
                    </tr>
        {% endfor %}
                </tr>
            </table>
        {% endif %}
        <a href="{{ path('indgestion_new',{ 'ficha_proyecto_id': entity.id }) }}" class="btn btn-success">
                Agregar Indicador de gestión
        </a>

    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Editar Ficha de Proyecto</button>

        <a href="{{ path('fichaproyecto') }}" class="btn">
            Regresar a Fichas de Proyectos
        </a>
    </div>
    </form>

    <form action="{{ path('fichaproyecto_delete', { 'id': entity.id }) }}" method="post">
            <input type="hidden" name="_method" value="DELETE" />
            {{ form_widget(delete_form) }}
            <button type="submit" class="btn btn-danger">Borrar Ficha Proyecto</button>
        </form>


{% block javascript %}

   <script type="text/javascript">
        var collectionHolder = $('div#chanpp_evimbundle_fichaproyectotype_activities');
        var $addTagLink = $('<a href="#" class="add_tag_link btn btn-success">Agregar una actividad</a>');
        var indexNo = 4;
        var $newFormDiv = $("<div id=borrar_actividad></div>");
        var $removeFormA = $('<a href="#">Borrar esta actividad</a>');
    </script>
    {% javascripts 
        '@chanppEvImBundle/Resources/public/js/addActividades.js'
        %}
        <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock %}

{% endblock %}




